---
layout: post
title:  "zsh"
categories: shell
tags: zsh shell
author: joshua
---



[为什么说 zsh 是 shell 中的极品](https://www.zhihu.com/question/21418449)

并不是传统基于正则表达式的色彩高亮，而是真的会判断你输入的是啥的色彩高亮：

![img](https://pic2.zhimg.com/50/v2-40c20690ceee02ebde6db7f5df326104_hd.jpg)

白色代表普通命令或者程序，红色代表错误命令

一个个字母的敲命令，前面都是红色的，如果敲对了最后一个字母的话，你会看到整条命令连着前面的都变成了白色，代表你敲对了。

下面青色的代表内建命令或者 alias （echo 和 ls ），这些都不是正则判断出来的，是真的去检查的

非零的错误码，也会高亮显示在最右边



命令提示和补全是两个完全不同的系统，很多时候提示比补全更有用

才输入完 “tar”命令，后面就用灰色给你提示 tar 命令的参数，而且是随着你动态输入完每一个字母不断修正变化

![img](https://pic4.zhimg.com/80/v2-adb8d887099606dbe6d556646bb8e5e4_1440w.jpg)

这个命令提示是基于你的历史命令数据库进行分析的，随着你输入的命令越来越多，提示将会越来越准确和顺手，某些不常输入的命令特别管用

如果你觉得它提示的正确，你可以 CTRL+F 表示采纳，后面就会自动帮你一次性全部输入完了



**智能补全**

**选择模式**，由两次连续 TAB 进入，进入后，除了 tab/shift+tab 可以前后切换外，你还可以使用光标键上下左右移动，或者使用 emacs 键位：ctrl + f/b/p/n (左右上下：forward, backward, previous, next) 。如果你觉得光标键太远难按，CTRL+f/b/p/n 太伤小拇指，可以跟我一样新定义出一套：ALT+hjkl （左下上右）来选择，十分顺手。回车表示确认选择，用 CTRL+G 表示退出

svn/git 这种一级参数基本都不需要补全的，我们一般会需要到二级参数补全，比如已经输入了 svn commit，但是有一个 commit 的参数我忘记了，我只记得两个减号开头的，于是：

![img](https://pic4.zhimg.com/80/v2-4101f36a2ca6c78d04e657b6816cc68e_1440w.jpg)



**快速跳转**

cd -

![img](https://pic4.zhimg.com/80/v2-ac647db39cecd9a4776205f905be2f4f_1440w.jpg)

```text
$ cd -5 <回车>
```

你还可以不输入数字，而是再按一次 tab 进入选择模式，上下键或者 ctrl+n/p 来选择，回车确认，ctrl+g 返回

**自动跳转**

用 z 命令，查看历史上进入过的目录：

![img](https://pic4.zhimg.com/80/v2-e2dce5c9e768b300c3fc32cd51c2dc48_1440w.jpg)

敲入 z 命令，列出了自从我开始用zsh进入过的目录和他们的权重，进入次数越多，权重越大

z 后面加一个关键词就能跳转到所有匹配的历史路径中权重最高的那个了：

![img](https://pic4.zhimg.com/80/v2-6b84e43fabc2c80140bae9dfac02d67d_1440w.jpg)

比如所有历史路径都包含 o ，那么 z o 就会跳转到权重最高的 ~/software 目录中

使用：“z -l foo" 可以列出包含 foo 的所有历史路径：

![img](https://pic4.zhimg.com/80/v2-5441d3c7f003838c0d2b1428f1972e02_1440w.jpg)

```text
project1/src
project2/src
```

增加一个关键字，比如 z 1 src ，空格分隔多个关键字，z会先匹配出第一个来，比如1 ，然后再匹配第二个 src ，马上锁定 project1/src 了

实际使用起来，一般是 z + 最后一级目录名，比如：

```bash
$ z vim     # -> /home/skywind/software/vim
$ z tmp     # -> /home/skywind/tmp
$ z local   # -> /home/skywind/.local
```

99%的时候这样做就足够了，当没有按照你要求跳转的时候，你可以再补充一下再上一级目录的一些信息，比如 z vim/src 或者 z v src 都可以，弄不明白会跳转到哪里，可以随时用：

```bash
$ z -l key1 [key2 ... ]
```



**热键绑定**

zsh 里面使用 bindkey 命令可以设置一系列热键，用来运行某一个 zsh 内部命令或者某个 shell 命令

```bash
bindkey -s '\eo' 'cd ..\n' # 按下ALT+O 就执行 cd .. 命令
bindkey -s '\e;' 'ls -l\n' # 按下 ALT+; 就执行 ls -l 命令
```

还可以设置一键打开编辑器，或者一键帮你输入某常用命令的一部分。除了这些命令外，日常命令编写也可以加强一下：

```bash
bindkey '\e[1;3D' backward-word       # ALT+左键：向后跳一个单词
bindkey '\e[1;3C' forward-word        # ALT+右键：前跳一个单词
bindkey '\e[1;3A' beginning-of-line   # ALT+上键：跳到行首
bindkey '\e[1;3B' end-of-line         # ALT+下键：调到行尾
```

敲命令时经常需要对已有命令进行修改，默认一个字符一个字符的跳太慢了，这样设置以后基于单词的跳转快速很多

~/.zshrc

想自己配置到话，推荐使 zsh 的包管理器：[antigen](https://link.zhihu.com/?target=https%3A//github.com/zsh-users/antigen) 来管理所有功能，用它配置起来比原始 oh-my-zsh 自动化多了

